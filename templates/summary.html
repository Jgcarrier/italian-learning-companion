{% extends "base.html" %}

{% block title %}Quiz Summary{% endblock %}

{% block content %}
<div class="summary-card">
    <h2>ğŸ“Š Quiz Complete!</h2>

    <div class="grade-display">{{ summary.grade_emoji }}</div>
    <div class="grade-text">{{ summary.grade }}</div>

    <div class="summary-stats">
        <div class="stat-item">
            <div class="label">Score</div>
            <div class="value">{{ summary.correct }}/{{ summary.total }}</div>
        </div>

        <div class="stat-item">
            <div class="label">Accuracy</div>
            <div class="value">{{ "%.1f"|format(summary.accuracy) }}%</div>
        </div>

        <div class="stat-item">
            <div class="label">Time</div>
            <div class="value" style="font-size: 1.3rem;">{{ summary.time }}</div>
        </div>
    </div>

    <div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid var(--medium-gray);">
        <p style="color: #666; font-size: 0.9rem;">Session saved to database (ID: {{ summary.session_id }})</p>
    </div>
</div>

<!-- Review Answers -->
<div class="mb-30">
    <h3 style="margin-bottom: 20px;">Review Your Answers</h3>

    {% for answer in summary.answers %}
        <div class="feedback {% if answer.is_correct %}correct{% else %}incorrect{% endif %}" style="margin-bottom: 15px; padding: 15px; text-align: left;">
            <div style="font-weight: 600; margin-bottom: 8px;">{{ answer.question }}</div>

            {% if answer.is_correct %}
                <div style="color: #059669;">âœ… {{ answer.user_answer }}</div>
            {% else %}
                <div style="color: #DC2626;">âŒ Your answer: {{ answer.user_answer }}</div>
                <div style="color: #059669;">âœ… Correct: {{ answer.correct_answer }}</div>
            {% endif %}
        </div>
    {% endfor %}
</div>

<div class="button-group">
    {% if practice_type == 'vocabulary_quiz' and direction %}
        <a href="{{ url_for('vocabulary_quiz', level=level, direction=direction) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'verb_conjugation' %}
        <a href="{{ url_for('verb_conjugation', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'regular_passato' %}
        <a href="{{ url_for('regular_passato', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'irregular_passato' %}
        <a href="{{ url_for('irregular_passato', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'imperfect_tense' %}
        <a href="{{ url_for('imperfect_tense', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'auxiliary_choice' %}
        <a href="{{ url_for('auxiliary_choice', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'futuro_semplice' %}
        <a href="{{ url_for('futuro_semplice', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'reflexive_verbs' %}
        <a href="{{ url_for('reflexive_verbs', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'noun_gender_number' %}
        <a href="{{ url_for('noun_gender_number', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'articulated_prepositions' %}
        <a href="{{ url_for('articulated_prepositions', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'time_prepositions' %}
        <a href="{{ url_for('time_prepositions', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'negations' %}
        <a href="{{ url_for('negations', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'fill_in_blank' %}
        <a href="{{ url_for('fill_in_blank', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'multiple_choice' %}
        <a href="{{ url_for('multiple_choice', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% elif practice_type == 'sentence_translation' %}
        <a href="{{ url_for('sentence_translator', level=level, direction=direction) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again</a>
    {% else %}
        <a href="{{ url_for('category_menu', level=level) }}" class="btn btn-primary" style="background: var(--green);">ğŸ”„ Practice Again ({{ level }})</a>
    {% endif %}

    <a href="{{ url_for('category_menu', level=level) }}" class="btn btn-secondary">ğŸ”™ Back to {{ level }} Menu</a>
    <a href="{{ url_for('home') }}" class="btn btn-secondary">ğŸ  Home (Choose Level)</a>
</div>
{% endblock %}
